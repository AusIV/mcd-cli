#!/usr/bin/env bash
### mcd-join -- Add collateral to the system
### Usage: mcd join <adapter> <amount>
###
### Specify the @adapter and the amount of collateral
### to deposit.
set -e
[ $# = 2 ] || mcd --fail "$0: Missing argument(s)"

join=$(mcd --to-address $1) || mcd --fail "$0: Invalid adapter $1"
urn=$(seth --to-word $ETH_FROM)

if [[ $join = $(mcd --to-address @join-eth) ]]; then
  wad=$(seth --to-wei $2 eth)
  (set -x; seth send $join 'join(bytes32)' $urn -V $wad)
else
  wad=$(seth --to-hex $(seth --to-wei $2 eth))
  (set -x; seth send $join "join(bytes32, uint)" $urn $wad)
fi
